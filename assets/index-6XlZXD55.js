(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Ue=(t,e)=>t===e,C=Symbol("solid-proxy"),pe=Symbol("solid-track"),W={equals:Ue};let Se=Oe;const E=1,H=2,Ee={owned:null,cleanups:null,context:null,owner:null};var g=null;let se=null,Ke=null,d=null,w=null,A=null,ee=0;function Be(t,e){const n=d,s=g,i=t.length===0,o=e===void 0?s:e,l=i?Ee:{owned:null,cleanups:null,context:o?o.context:null,owner:o},r=i?t:()=>t(()=>D(()=>te(l)));g=l,d=null;try{return j(r,!0)}finally{d=n,g=s}}function he(t,e){e=e?Object.assign({},W,e):W;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=i=>(typeof i=="function"&&(i=i(n.value)),$e(n,i));return[ke.bind(n),s]}function v(t,e,n){const s=de(t,e,!1,E);K(s)}function Pe(t,e,n){Se=Xe;const s=de(t,e,!1,E);s.user=!0,A?A.push(s):K(s)}function L(t,e,n){n=n?Object.assign({},W,n):W;const s=de(t,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,K(s),ke.bind(s)}function Re(t){return j(t,!1)}function D(t){if(d===null)return t();const e=d;d=null;try{return t()}finally{d=e}}function We(t){return g===null||(g.cleanups===null?g.cleanups=[t]:g.cleanups.push(t)),t}function re(){return d}function ke(){if(this.sources&&this.state)if(this.state===E)K(this);else{const t=w;w=null,j(()=>X(this),!1),w=t}if(d){const t=this.observers?this.observers.length:0;d.sources?(d.sources.push(this),d.sourceSlots.push(t)):(d.sources=[this],d.sourceSlots=[t]),this.observers?(this.observers.push(d),this.observerSlots.push(d.sources.length-1)):(this.observers=[d],this.observerSlots=[d.sources.length-1])}return this.value}function $e(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&j(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],l=se&&se.running;l&&se.disposed.has(o),(l?!o.tState:!o.state)&&(o.pure?w.push(o):A.push(o),o.observers&&Te(o)),l||(o.state=E)}if(w.length>1e6)throw w=[],new Error},!1)),e}function K(t){if(!t.fn)return;te(t);const e=ee;He(t,t.value,e)}function He(t,e,n){let s;const i=g,o=d;d=g=t;try{s=t.fn(e)}catch(l){return t.pure&&(t.state=E,t.owned&&t.owned.forEach(te),t.owned=null),t.updatedAt=n+1,Le(l)}finally{d=o,g=i}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?$e(t,s):t.value=s,t.updatedAt=n)}function de(t,e,n,s=E,i){const o={fn:t,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:g,context:g?g.context:null,pure:n};return g===null||g!==Ee&&(g.owned?g.owned.push(o):g.owned=[o]),o}function G(t){if(t.state===0)return;if(t.state===H)return X(t);if(t.suspense&&D(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<ee);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===E)K(t);else if(t.state===H){const s=w;w=null,j(()=>X(t,e[0]),!1),w=s}}function j(t,e){if(w)return t();let n=!1;e||(w=[]),A?n=!0:A=[],ee++;try{const s=t();return Ge(n),s}catch(s){n||(A=null),w=null,Le(s)}}function Ge(t){if(w&&(Oe(w),w=null),t)return;const e=A;A=null,e.length&&j(()=>Se(e),!1)}function Oe(t){for(let e=0;e<t.length;e++)G(t[e])}function Xe(t){let e,n=0;for(e=0;e<t.length;e++){const s=t[e];s.user?t[n++]=s:G(s)}for(e=0;e<n;e++)G(t[e])}function X(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const i=s.state;i===E?s!==e&&(!s.updatedAt||s.updatedAt<ee)&&G(s):i===H&&X(s,e)}}}function Te(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=H,n.pure?w.push(n):A.push(n),n.observers&&Te(n))}}function te(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),l=n.observerSlots.pop();s<i.length&&(o.sourceSlots[l]=s,i[s]=o,n.observerSlots[s]=l)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)te(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Ye(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Le(t,e=g){throw Ye(t)}let Ve=!1;function m(t,e){return D(()=>t(e||{}))}function R(){return!0}const le={get(t,e,n){return e===C?n:t.get(e)},has(t,e){return e===C?!0:t.has(e)},set:R,deleteProperty:R,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:R,deleteProperty:R}},ownKeys(t){return t.keys()}};function ie(t){return(t=typeof t=="function"?t():t)?t:{}}function Ze(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function me(...t){let e=!1;for(let l=0;l<t.length;l++){const r=t[l];e=e||!!r&&C in r,t[l]=typeof r=="function"?(e=!0,L(r)):r}if(e)return new Proxy({get(l){for(let r=t.length-1;r>=0;r--){const c=ie(t[r])[l];if(c!==void 0)return c}},has(l){for(let r=t.length-1;r>=0;r--)if(l in ie(t[r]))return!0;return!1},keys(){const l=[];for(let r=0;r<t.length;r++)l.push(...Object.keys(ie(t[r])));return[...new Set(l)]}},le);const n={},s=Object.create(null);for(let l=t.length-1;l>=0;l--){const r=t[l];if(!r)continue;const c=Object.getOwnPropertyNames(r);for(let f=c.length-1;f>=0;f--){const a=c[f];if(a==="__proto__"||a==="constructor")continue;const u=Object.getOwnPropertyDescriptor(r,a);if(!s[a])s[a]=u.get?{enumerable:!0,configurable:!0,get:Ze.bind(n[a]=[u.get.bind(r)])}:u.value!==void 0?u:void 0;else{const h=n[a];h&&(u.get?h.push(u.get.bind(r)):u.value!==void 0&&h.push(()=>u.value))}}}const i={},o=Object.keys(s);for(let l=o.length-1;l>=0;l--){const r=o[l],c=s[r];c&&c.get?Object.defineProperty(i,r,c):i[r]=c?c.value:void 0}return i}function Qe(t,...e){if(C in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(l=>new Proxy({get(r){return l.includes(r)?t[r]:void 0},has(r){return l.includes(r)&&r in t},keys(){return l.filter(r=>r in t)}},le));return o.push(new Proxy({get(l){return i.has(l)?void 0:t[l]},has(l){return i.has(l)?!1:l in t},keys(){return Object.keys(t).filter(l=>!i.has(l))}},le)),o}const n={},s=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),l=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let r=!1,c=0;for(const f of e)f.includes(i)&&(r=!0,l?s[c][i]=o.value:Object.defineProperty(s[c],i,o)),++c;r||(l?n[i]=o.value:Object.defineProperty(n,i,o))}return[...s,n]}const Je=t=>`Stale read from <${t}>.`;function et(t){const e=t.keyed,n=L(()=>t.when,void 0,{equals:(s,i)=>e?s===i:!s==!i});return L(()=>{const s=n();if(s){const i=t.children;return typeof i=="function"&&i.length>0?D(()=>i(e?s:()=>{if(!D(n))throw Je("Show");return t.when})):i}return t.fallback},void 0,void 0)}const tt=new Set(["innerHTML","textContent","innerText","children"]),nt=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),st=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),it={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function ot(t,e,n){let s=n.length,i=e.length,o=s,l=0,r=0,c=e[i-1].nextSibling,f=null;for(;l<i||r<o;){if(e[l]===n[r]){l++,r++;continue}for(;e[i-1]===n[o-1];)i--,o--;if(i===l){const a=o<s?r?n[r-1].nextSibling:n[o-r]:c;for(;r<o;)t.insertBefore(n[r++],a)}else if(o===r)for(;l<i;)(!f||!f.has(e[l]))&&e[l].remove(),l++;else if(e[l]===n[o-1]&&n[r]===e[i-1]){const a=e[--i].nextSibling;t.insertBefore(n[r++],e[l++].nextSibling),t.insertBefore(n[--o],a),e[i]=n[o]}else{if(!f){f=new Map;let u=r;for(;u<o;)f.set(n[u],u++)}const a=f.get(e[l]);if(a!=null)if(r<a&&a<o){let u=l,h=1,F;for(;++u<i&&u<o&&!((F=f.get(e[u]))==null||F!==a+h);)h++;if(h>a-r){const B=e[l];for(;r<a;)t.insertBefore(n[r++],B)}else t.replaceChild(n[r++],e[l++])}else l++;else e[l++].remove()}}}const Ce="_$DX_DELEGATE";function rt(t,e,n,s={}){let i;return Be(o=>{i=o,e===document?t():p(e,t(),e.firstChild?null:void 0,n)},s.owner),()=>{i(),e.textContent=""}}function P(t,e,n){let s;const i=()=>{const l=document.createElement("template");return l.innerHTML=t,l.content.firstChild},o=()=>(s||(s=i())).cloneNode(!0);return o.cloneNode=o,o}function ne(t,e=window.document){const n=e[Ce]||(e[Ce]=new Set);for(let s=0,i=t.length;s<i;s++){const o=t[s];n.has(o)||(n.add(o),e.addEventListener(o,dt))}}function ce(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function lt(t,e,n,s){s==null?t.removeAttributeNS(e,n):t.setAttributeNS(e,n,s)}function y(t,e){e==null?t.removeAttribute("class"):t.className=e}function ae(t,e,n,s){if(s)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const i=n[0];t.addEventListener(e,n[0]=o=>i.call(t,n[1],o))}else t.addEventListener(e,n)}function ct(t,e,n={}){const s=Object.keys(e||{}),i=Object.keys(n);let o,l;for(o=0,l=i.length;o<l;o++){const r=i[o];!r||r==="undefined"||e[r]||(ve(t,r,!1),delete n[r])}for(o=0,l=s.length;o<l;o++){const r=s[o],c=!!e[r];!r||r==="undefined"||n[r]===c||!c||(ve(t,r,!0),n[r]=c)}return n}function at(t,e,n){if(!e)return n?ce(t,"style"):e;const s=t.style;if(typeof e=="string")return s.cssText=e;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),e||(e={});let i,o;for(o in n)e[o]==null&&s.removeProperty(o),delete n[o];for(o in e)i=e[o],i!==n[o]&&(s.setProperty(o,i),n[o]=i);return n}function ft(t,e={},n,s){const i={};return v(()=>typeof e.ref=="function"&&De(e.ref,t)),v(()=>ut(t,e,n,!0,i,!0)),i}function De(t,e,n){return D(()=>t(e,n))}function p(t,e,n,s){if(n!==void 0&&!s&&(s=[]),typeof e!="function")return Y(t,e,s,n);v(i=>Y(t,e(),i,n),s)}function ut(t,e,n,s,i={},o=!1){e||(e={});for(const l in i)if(!(l in e)){if(l==="children")continue;i[l]=xe(t,l,null,i[l],n,o)}for(const l in e){if(l==="children")continue;const r=e[l];i[l]=xe(t,l,r,i[l],n,o)}}function ht(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function ve(t,e,n){const s=e.trim().split(/\s+/);for(let i=0,o=s.length;i<o;i++)t.classList.toggle(s[i],n)}function xe(t,e,n,s,i,o){let l,r,c,f;if(e==="style")return at(t,n,s);if(e==="classList")return ct(t,n,s);if(n===s)return s;if(e==="ref")o||n(t);else if(e.slice(0,3)==="on:"){const a=e.slice(3);s&&t.removeEventListener(a,s),n&&t.addEventListener(a,n)}else if(e.slice(0,10)==="oncapture:"){const a=e.slice(10);s&&t.removeEventListener(a,s,!0),n&&t.addEventListener(a,n,!0)}else if(e.slice(0,2)==="on"){const a=e.slice(2).toLowerCase(),u=st.has(a);if(!u&&s){const h=Array.isArray(s)?s[0]:s;t.removeEventListener(a,h)}(u||n)&&(ae(t,a,n,u),u&&ne([a]))}else if(e.slice(0,5)==="attr:")ce(t,e.slice(5),n);else if((f=e.slice(0,5)==="prop:")||(c=tt.has(e))||!i||(l=t.nodeName.includes("-")))f&&(e=e.slice(5),r=!0),e==="class"||e==="className"?y(t,n):l&&!r&&!c?t[ht(e)]=n:t[e]=n;else{const a=e.indexOf(":")>-1&&it[e.split(":")[0]];a?lt(t,a,e,n):ce(t,nt[e]||e,n)}return n}function dt(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const s=n[e];if(s&&!n.disabled){const i=n[`${e}Data`];if(i!==void 0?s.call(n,i,t):s.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Y(t,e,n,s,i){for(;typeof n=="function";)n=n();if(e===n)return n;const o=typeof e,l=s!==void 0;if(t=l&&n[0]&&n[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===n))return n;if(l){let r=n[0];r&&r.nodeType===3?r.data!==e&&(r.data=e):r=document.createTextNode(e),n=k(t,n,s,r)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||o==="boolean")n=k(t,n,s);else{if(o==="function")return v(()=>{let r=e();for(;typeof r=="function";)r=r();n=Y(t,r,n,s)}),()=>n;if(Array.isArray(e)){const r=[],c=n&&Array.isArray(n);if(fe(r,e,n,i))return v(()=>n=Y(t,r,n,s,!0)),()=>n;if(r.length===0){if(n=k(t,n,s),l)return n}else c?n.length===0?_e(t,r,s):ot(t,n,r):(n&&k(t),_e(t,r));n=r}else if(e.nodeType){if(Array.isArray(n)){if(l)return n=k(t,n,s,e);k(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function fe(t,e,n,s){let i=!1;for(let o=0,l=e.length;o<l;o++){let r=e[o],c=n&&n[t.length],f;if(!(r==null||r===!0||r===!1))if((f=typeof r)=="object"&&r.nodeType)t.push(r);else if(Array.isArray(r))i=fe(t,r,c)||i;else if(f==="function")if(s){for(;typeof r=="function";)r=r();i=fe(t,Array.isArray(r)?r:[r],Array.isArray(c)?c:[c])||i}else t.push(r),i=!0;else{const a=String(r);c&&c.nodeType===3&&c.data===a?t.push(c):t.push(document.createTextNode(a))}}return i}function _e(t,e,n=null){for(let s=0,i=e.length;s<i;s++)t.insertBefore(e[s],n)}function k(t,e,n,s){if(n===void 0)return t.textContent="";const i=s||document.createTextNode("");if(e.length){let o=!1;for(let l=e.length-1;l>=0;l--){const r=e[l];if(i!==r){const c=r.parentNode===t;!o&&!l?c?t.replaceChild(i,r):t.insertBefore(i,n):c&&r.remove()}else o=!0}}else t.insertBefore(i,n);return[i]}const gt=!1,ue=Symbol("store-raw"),O=Symbol("store-node"),_=Symbol("store-has"),je=Symbol("store-self");function Fe(t){let e=t[C];if(!e&&(Object.defineProperty(t,C,{value:e=new Proxy(t,bt)}),!Array.isArray(t))){const n=Object.keys(t),s=Object.getOwnPropertyDescriptors(t);for(let i=0,o=n.length;i<o;i++){const l=n[i];s[l].get&&Object.defineProperty(t,l,{enumerable:s[l].enumerable,get:s[l].get.bind(e)})}}return e}function V(t){let e;return t!=null&&typeof t=="object"&&(t[C]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function q(t,e=new Set){let n,s,i,o;if(n=t!=null&&t[ue])return n;if(!V(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let l=0,r=t.length;l<r;l++)i=t[l],(s=q(i,e))!==i&&(t[l]=s)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const l=Object.keys(t),r=Object.getOwnPropertyDescriptors(t);for(let c=0,f=l.length;c<f;c++)o=l[c],!r[o].get&&(i=t[o],(s=q(i,e))!==i&&(t[o]=s))}return t}function Z(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function I(t,e,n){if(t[e])return t[e];const[s,i]=he(n,{equals:!1,internal:!0});return s.$=i,t[e]=s}function yt(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===C||e===O||(delete n.value,delete n.writable,n.get=()=>t[C][e]),n}function Ne(t){re()&&I(Z(t,O),je)()}function wt(t){return Ne(t),Reflect.ownKeys(t)}const bt={get(t,e,n){if(e===ue)return t;if(e===C)return n;if(e===pe)return Ne(t),n;const s=Z(t,O),i=s[e];let o=i?i():t[e];if(e===O||e===_||e==="__proto__")return o;if(!i){const l=Object.getOwnPropertyDescriptor(t,e);re()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(l&&l.get)&&(o=I(s,e,o)())}return V(o)?Fe(o):o},has(t,e){return e===ue||e===C||e===pe||e===O||e===_||e==="__proto__"?!0:(re()&&I(Z(t,_),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:wt,getOwnPropertyDescriptor:yt};function Q(t,e,n,s=!1){if(!s&&t[e]===n)return;const i=t[e],o=t.length;n===void 0?(delete t[e],t[_]&&t[_][e]&&i!==void 0&&t[_][e].$()):(t[e]=n,t[_]&&t[_][e]&&i===void 0&&t[_][e].$());let l=Z(t,O),r;if((r=I(l,e,i))&&r.$(()=>n),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(r=l[c])&&r.$();(r=I(l,"length",o))&&r.$(t.length)}(r=l[je])&&r.$()}function ze(t,e){const n=Object.keys(e);for(let s=0;s<n.length;s+=1){const i=n[s];Q(t,i,e[i])}}function pt(t,e){if(typeof e=="function"&&(e=e(t)),e=q(e),Array.isArray(e)){if(t===e)return;let n=0,s=e.length;for(;n<s;n++){const i=e[n];t[n]!==i&&Q(t,n,i)}Q(t,"length",s)}else ze(t,e)}function M(t,e,n=[]){let s,i=t;if(e.length>1){s=e.shift();const l=typeof s,r=Array.isArray(t);if(Array.isArray(s)){for(let c=0;c<s.length;c++)M(t,[s[c]].concat(e),n);return}else if(r&&l==="function"){for(let c=0;c<t.length;c++)s(t[c],c)&&M(t,[c].concat(e),n);return}else if(r&&l==="object"){const{from:c=0,to:f=t.length-1,by:a=1}=s;for(let u=c;u<=f;u+=a)M(t,[u].concat(e),n);return}else if(e.length>1){M(t[s],e,[s].concat(n));return}i=t[s],n=[s].concat(n)}let o=e[0];typeof o=="function"&&(o=o(i,n),o===i)||s===void 0&&o==null||(o=q(o),s===void 0||V(i)&&V(o)&&!Array.isArray(o)?ze(i,o):Q(t,s,o))}function mt(...[t,e]){const n=q(t||{}),s=Array.isArray(n),i=Fe(n);function o(...l){Re(()=>{s&&l.length===1?pt(n,l[0]):M(n,l)})}return[i,o]}const Ct="_canvasContainer_alcme_1",vt="_canvasWrapper_alcme_7",xt="_canvas_alcme_1",oe={canvasContainer:Ct,canvasWrapper:vt,canvas:xt},x=["#FFF1E8","#000000","#FFCCAA","#1D2B53","#7E2553","#008751","#AB5236","#5F574F","#C2C3C7","#FF004D","#FFA300","#FFEC27","#00E436","#29ADFF","#83769C","#FF77A8"],_t=t=>{const e=parseInt(t.slice(1),16),n=e>>16&255,s=e>>8&255,i=e&255;return{r:n,g:s,b:i}};class T{x;y;constructor(e,n){this.x=e,this.y=n}set(e,n){this.x=e,this.y=n}}const b={LEFT:0,WHEEL:1,RIGHT:2};class At{panning;panToggle;canvasTransform;constructor(e){this.canvasTransform={pan:new T(0,0),zoom:1},this.panning=!1,this.panToggle=!1}}const Me=(t,e,n)=>{const s=new Uint8Array(3);return s[0]=t>>2&255,s[1]=(t&3)<<6|e>>4&63,s[2]=(e&15)<<4|n&15,s},qe=t=>{const e=(t[0]&255)<<2|t[1]>>6&3,n=(t[1]&63)<<4|t[2]>>4&15,s=t[2]&15;return{x:e,y:n,colorIndex:s}},St=(t,e)=>{const n=e*e,s=new Uint8ClampedArray(n*4);for(let i=0;i<n;i++){const o=t.slice(i*3,i*3+3),{colorIndex:l}=qe(o),{r,g:c,b:f}=_t(x[l]);s[i*4+0]=r,s[i*4+1]=c,s[i*4+2]=f,s[i*4+3]=255}return new ImageData(s,e,e)},$=256;let Et=class{element;context;editor;buffer;bufferCanvas;bufferContext;constructor({canvasElement:e,editor:n}){this.editor=n,this.element=e,this.element.width=$,this.element.height=$,this.context=e.getContext("2d");const s=$*$;this.buffer=new Uint8Array(s*3),this.bufferCanvas=new OffscreenCanvas(this.element.width,this.element.height),this.bufferContext=this.bufferCanvas.getContext("2d"),this.bufferContext.fillStyle=x[0],this.bufferContext.fillRect(0,0,this.element.width,this.element.height)}getImageData(e){return St(e,$)}updateBuffer(e){this.buffer.set(e),this.drawBuffer()}getPencilFillRect(e){return[e.coords.x-e.size/2,e.coords.y-e.size/2,e.size,e.size]}applyChanges(e){e.forEach(n=>{const s=n,i=s.size===1?0:s.size/2,o=s.coords.x-i,l=s.coords.y-i;for(let r=l;r<l+s.size;r++)for(let c=o;c<o+s.size;c++){const f=(r*$+c)*3;let a=x.findIndex(h=>h===n.color);a===-1&&(a=0);const u=Me(n.coords.x,n.coords.y,a);this.buffer.set(u,f)}})}drawBuffer(){const e=this.getImageData(this.buffer);this.bufferContext.putImageData(e,0,0),this.context.drawImage(this.bufferCanvas,0,0)}drawPencilPreview(){const e=this.editor.pencil.activeKey===b.LEFT?this.editor.pencil.primaryColor:this.editor.pencil.secondaryColor;this.context.fillStyle=e;const n=this.editor.pencil,s=n.size===1?0:n.size/2;this.context.fillRect(n.coords.x-s,n.coords.y-s,n.size,n.size)}draw(){this.drawBuffer(),this.drawPencilPreview()}};class Pt{primaryColor;secondaryColor;size;initialCoords;offsetCoords;coords;isDown;activeKey;constructor(){this.primaryColor=x[1],this.secondaryColor=x[0],this.size=1,this.initialCoords=new T(0,0),this.offsetCoords=new T(0,0),this.coords=new T(0,0),this.isDown=!1,this.activeKey=b.LEFT}}class kt{editor;webSocket;queue;constructor(e){this.editor=e,this.webSocket=new WebSocket("ws://152.228.215.209:8080"),this.queue=[],this.registerListeners(),this.loop()}getPackedMessage(e){const n=e.reduce((o,l)=>o+l.length,0),s=new Uint8Array(n);let i=0;return e.forEach(o=>{s.set(o,i),i+=o.length}),s}appendChange(e){const n=[],s=e,i=s.size===1?0:s.size/2,o=s.coords.x-i,l=s.coords.y-i;for(let r=l;r<l+s.size;r++)for(let c=o;c<o+s.size;c++){let f=x.findIndex(u=>u===e.color);f===-1&&(f=0);const a=Me(e.coords.x,e.coords.y,f);n.push(a)}this.queue.push(...n)}sendChanges(){console.log(`Websocket: Sending ${this.queue.length} updates`);const e=this.getPackedMessage(this.queue);this.webSocket.send(e),this.queue=[]}async onReceive(e){const s=await e.data.arrayBuffer(),i=new Uint8Array(s),o=i.length/3,l=[];for(let r=0;r<o;r++){const c=3*r,f=i.slice(c,c+3),a=qe(f);l.push({color:x[a.colorIndex],coords:new T(a.x,a.y),size:1})}console.log(`Websocket: Received ${l.length} updates`),this.editor.queueChange(l)}loop(){this.queue.length>0&&this.sendChanges(),setTimeout(()=>{this.loop()},1e3)}registerListeners(){this.webSocket.addEventListener("open",()=>console.log("Websocket: Connected")),this.webSocket.addEventListener("message",e=>this.onReceive(e))}}let $t=class{container;pencil;controls;socket;canvas;changes;constructor(e){this.container=e.parentElement,this.pencil=new Pt,this.controls=new At(e),this.socket=new kt(this),this.canvas=new Et({canvasElement:e,editor:this}),this.changes=[],this.registerEventListeners(),this.init(),this.update()}async fetchLatestSnapshot(){const n=await(await fetch("http://152.228.215.209:3000/api/canvas")).arrayBuffer();return new Uint8Array(n)}async init(){const e=await this.fetchLatestSnapshot();this.canvas.updateBuffer(e)}queueUserChange(e){this.queueChange(e),this.socket.appendChange(e)}queueChange(e){Array.isArray(e)||(e=[e]),this.changes.push(...e)}onPointerDown(e){this.pencil.initialCoords.set(e.x,e.y),e.target===this.canvas.element&&(e.button===b.LEFT&&!this.controls.panToggle&&(this.pencil.isDown=!0,this.pencil.activeKey=b.LEFT,this.queueUserChange({coords:this.pencil.coords,color:this.pencil.primaryColor,size:this.pencil.size})),e.button===b.RIGHT&&(this.pencil.isDown=!0,this.pencil.activeKey=b.RIGHT,this.queueUserChange({coords:this.pencil.coords,color:U.secondaryColor,size:this.pencil.size}))),(e.button===b.WHEEL||this.controls.panToggle)&&(this.controls.panning=!0)}onPointerUp(e){this.pencil.isDown=!1,this.pencil.activeKey=b.LEFT,(e.button===b.WHEEL||this.controls.panToggle)&&(this.controls.panning=!1,this.controls.canvasTransform.pan.set(this.controls.canvasTransform.pan.x+this.pencil.offsetCoords.x,this.controls.canvasTransform.pan.y+this.pencil.offsetCoords.y),this.pencil.offsetCoords.set(0,0))}onPointerMove(e){const n=this.canvas.element.getBoundingClientRect();if(this.pencil.coords.set(Math.floor((e.x-n.left)/n.width*this.canvas.element.width),Math.floor((e.y-n.top)/n.height*this.canvas.element.height)),this.pencil.isDown){const s=this.pencil.activeKey===b.LEFT?this.pencil.primaryColor:this.pencil.secondaryColor;this.queueUserChange({coords:this.pencil.coords,color:s,size:this.pencil.size})}this.controls.panning&&this.pencil.offsetCoords.set(e.x-this.pencil.initialCoords.x,e.y-this.pencil.initialCoords.y)}onWheel(e){if(e.preventDefault(),!(e.deltaX>0&&e.deltaY>0)){const s=this.controls.canvasTransform.zoom+e.deltaY*-.01;this.controls.canvasTransform.zoom=s<.5?.5:s}}onKeyDown(e){e.code==="Space"&&(this.controls.panToggle=!0)}onKeyUp(e){e.code==="Space"&&(this.controls.panToggle=!1)}applyTransform(){const e=new T(this.controls.canvasTransform.pan.x+this.pencil.offsetCoords.x,this.controls.canvasTransform.pan.y+this.pencil.offsetCoords.y);this.container.style.transform=`scale(${this.controls.canvasTransform.zoom}) translate(${e.x}px, ${e.y}px)`}update(){this.applyTransform(),this.canvas.applyChanges(this.changes),this.changes=[],this.canvas.draw(),requestAnimationFrame(()=>this.update())}registerEventListeners(){window.addEventListener("contextmenu",e=>e.preventDefault()),window.addEventListener("pointerdown",e=>this.onPointerDown(e)),window.addEventListener("pointerup",e=>this.onPointerUp(e)),window.addEventListener("pointermove",e=>this.onPointerMove(e)),window.addEventListener("wheel",e=>this.onWheel(e),{passive:!1}),window.addEventListener("keydown",e=>this.onKeyDown(e)),window.addEventListener("keyup",e=>this.onKeyUp(e))}};var Ot=P("<div><div><canvas>");const Tt=()=>{let t;const e=n=>{t=new $t(n)};return Pe(()=>{t.pencil.primaryColor=U.primaryColor,t.pencil.secondaryColor=U.secondaryColor}),(()=>{var n=Ot(),s=n.firstChild,i=s.firstChild;return De(e,i),v(o=>{var l=oe.canvasContainer,r=oe.canvasWrapper,c=oe.canvas;return l!==o.e&&y(n,o.e=l),r!==o.t&&y(s,o.t=r),c!==o.a&&y(i,o.a=c),o},{e:void 0,t:void 0,a:void 0}),n})()},Lt="_editor_dxltd_1",Dt={editor:Lt};var jt=P("<svg stroke-width=0>");function Ie(t,e){const n=me(t.a,e),[s,i]=Qe(n,["src"]),[o,l]=he(""),r=L(()=>e.title?`${t.c}<title>${e.title}</title>`:t.c);return Pe(()=>l(r())),We(()=>{l("")}),(()=>{var c=jt();return ft(c,me({get stroke(){return t.a?.stroke},get color(){return e.color||"currentColor"},get fill(){return e.color||"currentColor"},get style(){return{...e.style,overflow:"visible"}}},i,{get height(){return e.size||"1em"},get width(){return e.size||"1em"},xmlns:"http://www.w3.org/2000/svg",get innerHTML(){return o()}}),!0),p(c,()=>gt),c})()}function J(t){return Ie({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-caret-down",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 10l6 6l6 -6h-12"/>'},t)}function Ft(t){return Ie({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-help",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"/><path d="M12 17l0 .01"/><path d="M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"/>'},t)}const Nt="_title_12w0k_21",zt="_logo_12w0k_28",Mt="_button_12w0k_35",qt="_icon_12w0k_40",N={interface:"_interface_12w0k_1",title:Nt,logo:zt,button:Mt,icon:qt},It="_manual_1qmbt_1",Ut="_close_1qmbt_14",Kt="_shortcut_1qmbt_27",Bt="_symbol_1qmbt_35",S={manual:It,close:Ut,shortcut:Kt,symbol:Bt};var Rt=P("<div><button>Fermer</button><ul><li><span>Clic Gauche</span>Peindre la couleur principale </li><li><span>Clic Gauche</span>Peindre la couleur secondaire </li><li><span>Clic Molette</span>Deplacer la toile</li><li><span>Scroll</span>Zoom +/-");const Wt=t=>(()=>{var e=Rt(),n=e.firstChild,s=n.nextSibling,i=s.firstChild,o=i.firstChild;o.nextSibling;var l=i.nextSibling,r=l.firstChild;r.nextSibling;var c=l.nextSibling,f=c.firstChild,a=c.nextSibling,u=a.firstChild;return n.$$click=()=>{t.setManual(!1)},p(i,m(J,{get class(){return S.symbol},color:"white",fill:"white","stroke-width":1}),null),p(l,m(J,{get class(){return S.symbol},color:"white","stroke-width":1}),null),v(h=>{var F=S.manual,B=S.close,ge=S.shortcut,ye=S.shortcut,we=S.shortcut,be=S.shortcut;return F!==h.e&&y(e,h.e=F),B!==h.t&&y(n,h.t=B),ge!==h.a&&y(o,h.a=ge),ye!==h.o&&y(r,h.o=ye),we!==h.i&&y(f,h.i=we),be!==h.n&&y(u,h.n=be),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),e})();ne(["click"]);const Ht="_palette_18fr4_1",Gt="_colorContainer_18fr4_7",Xt="_colorState_18fr4_11",Yt="_color_18fr4_7",z={palette:Ht,colorContainer:Gt,colorState:Xt,color:Yt};var Vt=P("<div>"),Zt=P("<div><button>");const Qt=()=>{const t=e=>n=>{n.preventDefault(),n.button===b.LEFT&&Ae("primaryColor",e),n.button===b.RIGHT&&Ae("secondaryColor",e)};return(()=>{var e=Vt();return p(e,()=>x.map(n=>(()=>{var s=Zt(),i=s.firstChild;return p(s,(()=>{var o=L(()=>n===U.primaryColor);return()=>o()&&m(J,{get class(){return z.colorState},color:"white",fill:"white","stroke-width":1})})(),i),p(s,(()=>{var o=L(()=>n===U.secondaryColor);return()=>o()&&m(J,{get class(){return z.colorState},color:"white","stroke-width":1})})(),i),ae(i,"click",t(n),!0),ae(i,"contextmenu",t(n),!0),n!=null?i.style.setProperty("background",n):i.style.removeProperty("background"),v(o=>{var l=z.colorContainer,r=z.color;return l!==o.e&&y(s,o.e=l),r!==o.t&&y(i,o.t=r),o},{e:void 0,t:void 0}),s})())),v(()=>y(e,z.palette)),e})()};ne(["contextmenu","click"]);var Jt=P('<div><header><div><img src=https://inner-sun.github.io/mochi-place/assets/images/logo.png alt=""><span>MochiPlace</span></div><button>');const en=()=>{const[t,e]=he(!0),n=()=>e(s=>!s);return(()=>{var s=Jt(),i=s.firstChild,o=i.firstChild,l=o.firstChild,r=o.nextSibling;return p(i,m(Qt,{}),r),r.$$click=n,p(r,m(Ft,{get class(){return N.icon}})),p(s,m(et,{get when(){return t()},get children(){return m(Wt,{setManual:e})}}),null),v(c=>{var f=N.interface,a=N.title,u=N.logo,h=N.button;return f!==c.e&&y(s,c.e=f),a!==c.t&&y(o,c.t=a),u!==c.a&&y(l,c.a=u),h!==c.o&&y(r,c.o=h),c},{e:void 0,t:void 0,a:void 0,o:void 0}),s})()};ne(["click"]);var tn=P("<div>");const[U,Ae]=mt({primaryColor:x[1],secondaryColor:x[0],size:1}),nn=()=>(()=>{var t=tn();return p(t,m(en,{}),null),p(t,m(Tt,{}),null),v(()=>y(t,Dt.editor)),t})(),sn=document.getElementById("root");rt(()=>m(nn,{}),sn);
